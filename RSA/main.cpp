#include <NTL/ZZ.h>
#include "RSA.h"
#include <ctime>

using namespace std;
using namespace NTL;

int main(){
    int bytes=1024;
    time_t instanteInicial, instanteFinal;
    ZZ mc;
    /*ZZ e_n,n_n,d_n;
    ZZ e; ZZ n;
    e=conv<ZZ>("5907457461944252726974432764365891336081391822051948031743917059914628737128199104813925494654714733527215900709039015608470752674069041219505200520254702735409779561308923469486819577430335387460485593954243366034344042993757151121969367923741535311255163595527708674554974152566464293813000444096214572319236227563062186123174995262166128552495406856262572782300868819507578314867622464133851012776090300226435696372528811065725144208979228794893549342175842870711852259709476561519739153736636965389969406252764028879223769675071984021095361134155574018757794295357648944505498090718013915374246691538016000603969");
    n=conv<ZZ>("8609319275615354566377233160810589297036338214688699967505262253482404879721747462637957551888408130381670549164752949053018638937471476203602802864483433598690912490386608322035173362462101680924287248374566233787891127654132477855887849427104461405274211077294372739288029862116612548944781608964095084447654688691393951255048662448665405015459259162338801776378547848031611539301524755708398795217191256010516122356447135751024785857197968837229585516036517769172025217004722797352991350933635285013709033353844145524719980702809581485090369927040377123668826975557426977634796138940127295426490555861200373883147");
    */
    /*e_n=291283908227013947;
    n_n=6464424120687136367;
    d_n=1678614242460564083;*/

    string mcb,md,mensaje="ESTERNOCLEIDOMASTOIDEOESTERNOCLEIDOMASTOIDEOESTERNOCLEIDOMASTOIDEOESTERNOCLEIDOMASTOIDEOESTERNOCLEIDOMASTOIDEOESTERNOCLEIDOMASTOIDEO";
    //string men_d="";;

    // Cifrado Pasando Palabras
    //RSA emisor("a",e_n,n_n);
    instanteInicial = time(0);
    RSA emisor(bytes);
    mc=emisor.cifrado(mensaje);
    cout<<"Mensaje Cifrado: "<<mc<<endl;
    md=emisor.descifrado(mc);
    cout<<"Mensaje Descifrado: "<<md<<endl;
    instanteFinal = time(0);
    cout << "Segundos empleados: " << instanteFinal - instanteInicial << endl;

    // Para descifrar
    /*RSA emisor("des",d_n,n_n,men_d);
    md=emisor.descifrado(d);
    cout<<"Mensaje Descifrado Pal: "<<md<<endl;*/

    // Cifrado Usando Bloques
    /*RSA emisor(bytes);
    //RSA emisor("des_b",e,n);
    mcb=emisor.cifradoblocks(mensaje);
    cout<<"Mensaje Cifrado: "<<mcb<<endl;
    md=emisor.descifradoblocks(mcb);
    //md=emisor.descifradoblocks(desmen);
    cout<<"Mensaje Descifrado: "<<md<<endl;*/

    // Para descifrar
    /*RSA emisor("des_b",d_n,n_n);
    md=emisor.descifradoblocks(men_d);
    cout<<"Mensaje Descifrado Pal: "<<md<<endl;*/

    return 0;
}
